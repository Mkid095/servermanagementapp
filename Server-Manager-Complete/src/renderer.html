<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Server Manager</title>
    <link rel="stylesheet" href="styles/server-list.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Server Manager</h1>
            <p>Manage your development servers</p>
        </div>
        
        <div class="content">
            <div id="server-list-container"></div>
        </div>
    </div>

    <script>
        const { ipcRenderer } = require('electron');
        
        // Expose IPC functions to window.electronAPI for easier access
        window.electronAPI = {
            getServers: async () => {
                return await ipcRenderer.invoke('get-servers');
            },
            
            stopServer: async (pid) => {
                return await ipcRenderer.invoke('stop-server', pid);
            },
            
            restartServer: async (pid) => {
                return await ipcRenderer.invoke('restart-server', pid);
            },
            
            getProcessDetails: async (pid) => {
                return await ipcRenderer.invoke('get-process-details', pid);
            },
            
            getServerErrorLogs: async (pid) => {
                return await ipcRenderer.invoke('get-server-error-logs', pid);
            },
            
            clearServerErrorLogs: async (pid) => {
                return await ipcRenderer.invoke('clear-server-error-logs', pid);
            },
            
            refreshServers: async () => {
                return await ipcRenderer.invoke('refresh-servers');
            }
        };

        // Import ServerList component
        const ServerList = require('./components/ServerList');
        
        // Initialize the application
        let serverList;
        
        document.addEventListener('DOMContentLoaded', () => {
            serverList = new ServerList('server-list-container');
            
            // Initial load
            serverList.refreshServers();
            
            // Auto-refresh every 5 seconds
            setInterval(() => {
                serverList.refreshServers();
            }, 5000);
            
            // Listen for server updates from main process
            ipcRenderer.on('servers-updated', (event, servers) => {
                serverList.updateServers(servers);
            });
            
            // Listen for refresh requests from tray
            ipcRenderer.on('refresh-servers', () => {
                serverList.refreshServers();
            });
        });
    </script>
</body>
</html>